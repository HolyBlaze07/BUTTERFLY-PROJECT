<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Butterfly Hub" />
    <meta name="format-detection" content="telephone=no" />
    <title>Butterfly Hub - Butterfly Games Collection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <!-- Butterfly Theme System -->
    <script src="js/butterfly-theme.js"></script>
    <link rel="stylesheet" href="css/theme-selector.css" />
    <script src="js/theme-selector.js" defer></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
      }

      html {
        /* Prevent iOS text size adjustment */
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;
        /* Smooth scrolling for iOS */
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
      }

      body {
        font-family: "Orbitron", "Press Start 2P", "Arial Black", sans-serif;
        background: var(
          --bg-gradient,
          linear-gradient(
            180deg,
            #0a0e27 0%,
            #1a1f4d 30%,
            #2d1b69 60%,
            #1a1033 100%
          )
        );
        background-attachment: fixed;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        display: flex;
        flex-direction: column;
        align-items: center;
        color: #fff;
        overflow-x: hidden;
        position: relative;
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
        /* iOS Safari optimization */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: radial-gradient(
            2px 2px at 20% 30%,
            white,
            transparent
          ),
          radial-gradient(2px 2px at 60% 70%, #ff69b4, transparent),
          radial-gradient(1px 1px at 50% 50%, #fff, transparent),
          radial-gradient(1px 1px at 80% 10%, #00ffff, transparent),
          radial-gradient(2px 2px at 90% 60%, #fff, transparent),
          radial-gradient(1px 1px at 33% 80%, #ff00ff, transparent),
          radial-gradient(1px 1px at 15% 90%, #fff, transparent),
          radial-gradient(2px 2px at 75% 25%, #fff, transparent),
          radial-gradient(2px 2px at 40% 15%, #fff, transparent),
          radial-gradient(1px 1px at 65% 45%, #00ffff, transparent),
          radial-gradient(2px 2px at 25% 60%, #ff69b4, transparent),
          radial-gradient(1px 1px at 85% 75%, #fff, transparent),
          radial-gradient(2px 2px at 10% 20%, #fff, transparent),
          radial-gradient(1px 1px at 95% 40%, #ff00ff, transparent),
          radial-gradient(2px 2px at 45% 85%, #fff, transparent),
          radial-gradient(1px 1px at 70% 5%, #00ffff, transparent),
          radial-gradient(2px 2px at 30% 50%, #fff, transparent),
          radial-gradient(1px 1px at 55% 95%, #ff69b4, transparent),
          radial-gradient(2px 2px at 5% 65%, #fff, transparent),
          radial-gradient(1px 1px at 88% 88%, #fff, transparent);
        background-size: 200% 200%;
        background-position: 0% 0%;
        pointer-events: none;
        z-index: 1;
        animation: starTwinkle 8s ease-in-out infinite;
      }

      @keyframes starTwinkle {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      body::after {
        content: "";
        position: fixed;
        top: 5%;
        right: 8%;
        width: 200px;
        height: 200px;
        background-image: url("assets/pixel-moon.png");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        image-rendering: pixelated;
        pointer-events: none;
        z-index: 1;
        filter: drop-shadow(0 0 20px rgba(255, 255, 200, 0.4))
          drop-shadow(0 0 40px rgba(200, 150, 255, 0.3));
      }

      .pixel-moon {
        position: fixed;
        top: 5%;
        right: 8%;
        width: 200px;
        height: 200px;
        background-image: url("assets/pixel-moon.png");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        image-rendering: pixelated;
        pointer-events: none;
        z-index: 1;
        filter: drop-shadow(0 0 20px rgba(255, 255, 200, 0.6))
          drop-shadow(0 0 40px rgba(200, 150, 255, 0.5));
      }
      @keyframes moonFloat {
        0%,
        100% {
          transform: translateY(0px);
          filter: brightness(1);
        }
        50% {
          transform: translateY(-10px);
          filter: brightness(1.15);
        }
      }

      .header {
        width: 100%;
        padding: 2rem;
        padding-top: max(2rem, env(safe-area-inset-top));
        text-align: center;
        background: linear-gradient(
          180deg,
          rgba(42, 36, 115, 0.95) 0%,
          rgba(26, 15, 51, 0.95) 100%
        );
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-bottom: 4px solid;
        border-image: linear-gradient(90deg, #ff69b4, #00ffff, #ff00ff, #4169e1)
          1;
        position: relative;
        z-index: 10;
        box-shadow: 0 0 20px rgba(255, 105, 180, 0.4),
          0 0 40px rgba(65, 105, 225, 0.3), 0 4px 0 rgba(255, 0, 255, 0.3);
      }

      .header-actions {
        position: absolute;
        top: 1.5rem;
        right: 2rem;
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
      }

      .auth-link {
        padding: 0.75rem 1.5rem;
        min-height: 44px;
        border: 2px solid #00ffff;
        color: #00ffff;
        text-decoration: none;
        font-size: 0.9rem;
        font-weight: bold;
        text-transform: uppercase;
        background: rgba(10, 14, 39, 0.6);
        transition: all 0.3s ease;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.4);
        cursor: pointer;
        touch-action: manipulation;
      }

      .auth-link:active {
        transform: scale(0.95);
      }

      .auth-link:hover {
        color: #0a0e27;
        background: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.7);
      }

      .user-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem 0.9rem;
        border: 2px solid #ff69b4;
        background: rgba(5, 10, 40, 0.6);
        box-shadow: 0 0 15px rgba(255, 105, 180, 0.4);
        text-align: left;
      }

      .user-avatar {
        width: 36px;
        height: 36px;
        image-rendering: pixelated;
      }

      .user-name {
        font-size: 0.95rem;
        font-weight: bold;
        color: #00ffff;
      }

      .user-label {
        font-size: 0.7rem;
        color: #ff69b4;
        letter-spacing: 1px;
        text-transform: uppercase;
      }

      .sign-out-btn {
        padding: 0.5rem 0.9rem;
        min-height: 44px;
        border: 1px solid #ff00ff;
        background: rgba(255, 0, 255, 0.15);
        color: #fff;
        font-size: 0.7rem;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s ease;
        touch-action: manipulation;
      }

      .sign-out-btn:active {
        transform: scale(0.95);
      }

      .sign-out-btn:hover {
        background: #ff00ff;
        color: #0a0e27;
      }

      .header h1 {
        font-size: clamp(1.5rem, 5vw, 2.5rem);
        margin-bottom: 1rem;
        font-weight: bold;
        text-shadow: 3px 3px 0px #ff69b4, -2px -2px 0px #00ffff,
          0 0 20px rgba(255, 105, 180, 1), 0 0 40px rgba(65, 105, 225, 0.8),
          0 0 60px rgba(255, 0, 255, 0.6);
        color: #fff;
        letter-spacing: 2px;
        animation: pixelGlow 3s ease-in-out infinite;
      }

      @keyframes pixelGlow {
        0%,
        100% {
          text-shadow: 3px 3px 0px #ff69b4, -2px -2px 0px #00ffff,
            0 0 20px rgba(255, 105, 180, 1);
        }
        50% {
          text-shadow: 3px 3px 0px #00ffff, -2px -2px 0px #ff69b4,
            0 0 30px rgba(65, 105, 225, 1), 0 0 60px rgba(255, 0, 255, 0.8);
        }
      }

      .header p {
        font-size: clamp(0.85rem, 2.5vw, 1rem);
        color: #ff69b4;
        margin-bottom: 2rem;
        text-shadow: 0 0 10px rgba(255, 105, 180, 0.8), 2px 2px 0px #4169e1;
        font-weight: bold;
      }

      .games-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
        gap: 2rem;
        padding: 2rem;
        padding-bottom: max(2rem, env(safe-area-inset-bottom));
        max-width: 1200px;
        width: 100%;
        position: relative;
        z-index: 10;
      }

      .game-card {
        background: linear-gradient(
          180deg,
          rgba(138, 43, 226, 0.3) 0%,
          rgba(75, 0, 130, 0.5) 50%,
          rgba(42, 36, 115, 0.7) 100%
        );
        border-radius: 0px;
        padding: 2rem;
        text-align: center;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 4px solid;
        border-image: linear-gradient(
            135deg,
            #ff69b4,
            #00ffff,
            #ff00ff,
            #4169e1
          )
          1;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        box-shadow: 0 0 15px rgba(255, 105, 180, 0.5),
          0 0 30px rgba(65, 105, 225, 0.3),
          inset 0 0 30px rgba(138, 43, 226, 0.2), 0 8px 0 rgba(75, 0, 130, 0.5);
        cursor: pointer;
        touch-action: manipulation;
      }

      @media (hover: hover) {
        .game-card:hover {
          transform: translateY(-8px) scale(1.03);
          box-shadow: 0 0 25px rgba(255, 105, 180, 0.9),
            0 0 50px rgba(65, 105, 225, 0.7), 0 0 75px rgba(255, 0, 255, 0.5),
            inset 0 0 40px rgba(138, 43, 226, 0.3), 0 12px 0 rgba(75, 0, 130, 0.7);
          animation: pixelPulse 0.5s ease-in-out;
        }
      }

      .game-card:active {
        transform: translateY(-4px) scale(0.98);
      }

      @keyframes pixelPulse {
        0%,
        100% {
          filter: brightness(1);
        }
        50% {
          filter: brightness(1.2);
        }
      }

      .game-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 105, 180, 0.4),
          rgba(65, 105, 225, 0.4),
          transparent
        );
        transition: left 0.5s;
      }

      @media (hover: hover) {
        .game-card:hover::before {
          left: 100%;
        }
      }

      .game-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
        display: block;
        filter: drop-shadow(0 0 10px #ff00ff) drop-shadow(0 0 20px #00ffff);
        animation: iconFloat 2s ease-in-out infinite;
      }

      @keyframes iconFloat {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .game-title {
        font-size: clamp(1.2rem, 3.5vw, 1.5rem);
        margin-bottom: 0.5rem;
        color: #0ff;
        text-shadow: 2px 2px 0px #ff00ff, -1px -1px 0px #ffff00,
          0 0 10px rgba(0, 255, 255, 0.8);
        font-weight: bold;
        letter-spacing: 2px;
      }

      .game-description {
        color: #fff;
        margin-bottom: 1.5rem;
        line-height: 1.6;
        text-shadow: 1px 1px 2px rgba(255, 0, 255, 0.5);
        font-size: clamp(0.85rem, 2vw, 1rem);
      }

      .game-features {
        list-style: none;
        margin-bottom: 2rem;
        text-align: left;
      }

      .game-features li {
        margin-bottom: 0.5rem;
        padding-left: 1.5rem;
        position: relative;
        color: #fff;
        text-shadow: 1px 1px 0px rgba(0, 255, 255, 0.5);
      }

      .game-features li::before {
        content: "";
        position: absolute;
        left: 0;
        width: 20px;
        height: 20px;
        background-image: url("assets/Butterfly3.png");
        background-size: contain;
        background-repeat: no-repeat;
        filter: drop-shadow(0 0 5px #ff00ff) drop-shadow(0 0 10px #00ffff);
        animation: butterflySpin 3s linear infinite;
      }

      @keyframes butterflySpin {
        0%,
        100% {
          transform: rotate(0deg);
        }
        50% {
          transform: rotate(180deg);
        }
      }

      .open-button {
        background: linear-gradient(135deg, #ff00ff, #00ffff, #ffff00, #ff00ff);
        background-size: 200% 200%;
        border: 2px solid #0ff;
        border-radius: 20px;
        color: #000;
        padding: 1rem 2.5rem;
        min-height: 48px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 0 10px rgba(255, 0, 255, 0.6),
          0 0 20px rgba(0, 255, 255, 0.4),
          inset 0 0 10px rgba(255, 255, 255, 0.3);
        animation: gradientShift 3s ease infinite;
        text-shadow: 1px 1px 0px rgba(255, 0, 255, 0.8);
        touch-action: manipulation;
        -webkit-user-select: none;
        user-select: none;
      }

      .open-button:active {
        transform: scale(0.95);
      }

      @media (hover: hover) {
        .open-button:hover {
          transform: scale(1.1);
          box-shadow: 0 0 20px rgba(255, 0, 255, 0.9),
            0 0 40px rgba(0, 255, 255, 0.7), 0 0 60px rgba(255, 255, 0, 0.5),
            inset 0 0 20px rgba(255, 255, 255, 0.5);
          animation: buttonGlitch 0.5s ease-in-out;
        }
      }

      @keyframes buttonGlitch {
        0%,
        100% {
          transform: scale(1.1);
        }
        25% {
          transform: scale(1.1) skew(3deg);
        }
        75% {
          transform: scale(1.1) skew(-3deg);
        }
      }

      @keyframes gradientShift {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      .stats-panel {
        background: linear-gradient(
          180deg,
          rgba(75, 0, 130, 0.9) 0%,
          rgba(42, 36, 115, 0.9) 100%
        );
        border-radius: 0px;
        padding: 1.5rem;
        margin: 2rem;
        text-align: center;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 4px solid;
        border-image: linear-gradient(
            135deg,
            #ff69b4,
            #00ffff,
            #ff00ff,
            #4169e1
          )
          1;
        box-shadow: 0 0 25px rgba(255, 105, 180, 0.6),
          0 0 50px rgba(65, 105, 225, 0.4),
          inset 0 0 40px rgba(138, 43, 226, 0.2), 0 6px 0 rgba(42, 36, 115, 0.8);
        position: relative;
        z-index: 10;
      }

      .stats-title {
        color: #ff69b4;
        font-size: clamp(1.1rem, 3vw, 1.3rem);
        text-shadow: 2px 2px 0px #4169e1, -1px -1px 0px #00ffff,
          0 0 20px rgba(255, 105, 180, 1), 0 0 40px rgba(65, 105, 225, 0.8);
        font-weight: bold;
        letter-spacing: 2px;
        margin-bottom: 1rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
      }

      .stat-item {
        background: rgba(42, 36, 115, 0.7);
        padding: 1rem;
        border-radius: 0px;
        border: 3px solid;
        border-image: linear-gradient(135deg, #ff69b4, #00ffff, #4169e1) 1;
        box-shadow: 0 0 15px rgba(255, 105, 180, 0.5),
          inset 0 0 20px rgba(138, 43, 226, 0.3), 0 4px 0 rgba(75, 0, 130, 0.6);
        transition: all 0.3s ease;
      }

      .stat-item:hover {
        box-shadow: 0 0 25px rgba(255, 105, 180, 0.9),
          0 0 50px rgba(65, 105, 225, 0.7),
          inset 0 0 30px rgba(138, 43, 226, 0.5), 0 6px 0 rgba(75, 0, 130, 0.8);
        transform: scale(1.05);
      }

      .stat-value {
        font-size: 2rem;
        color: #00ffff;
        font-weight: bold;
        text-shadow: 2px 2px 0px #ff69b4, 0 0 15px rgba(0, 255, 255, 1),
          0 0 30px rgba(255, 105, 180, 0.7);
      }

      .stat-label {
        color: #fff;
        font-size: 0.85rem;
        text-shadow: 1px 1px 2px rgba(255, 105, 180, 0.5);
        font-weight: bold;
      }

      .floating-butterfly {
        position: absolute;
        animation: float 6s ease-in-out infinite;
        pointer-events: none;
        filter: drop-shadow(0 0 10px #ff00ff) drop-shadow(0 0 20px #00ffff)
          drop-shadow(0 0 30px #ffff00);
        z-index: 1;
      }

      .floating-butterfly img {
        width: 80px;
        height: auto;
        image-rendering: pixelated;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
          filter: drop-shadow(0 0 10px #ff00ff) drop-shadow(0 0 20px #00ffff);
        }
        25% {
          transform: translateY(-20px) rotate(5deg);
          filter: drop-shadow(0 0 15px #00ffff) drop-shadow(0 0 25px #ffff00);
        }
        50% {
          transform: translateY(-10px) rotate(-5deg);
          filter: drop-shadow(0 0 20px #ffff00) drop-shadow(0 0 30px #00ff00);
        }
        75% {
          transform: translateY(-15px) rotate(3deg);
          filter: drop-shadow(0 0 15px #00ff00) drop-shadow(0 0 25px #ff00ff);
        }
      }

      .butterfly-1 {
        top: 10%;
        left: 10%;
        animation-delay: 0s;
      }
      .butterfly-2 {
        top: 20%;
        right: 15%;
        animation-delay: 2s;
      }
      .butterfly-3 {
        bottom: 20%;
        left: 20%;
        animation-delay: 4s;
      }

      /* iPad and Tablet Optimizations */
      @media (min-width: 768px) and (max-width: 1024px) {
        .games-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 1.5rem;
          padding: 1.5rem;
        }

        .header h1 {
          font-size: 2.2rem;
        }

        .header-actions {
          position: static;
          justify-content: center;
          margin-bottom: 1.5rem;
        }
      }

      /* Mobile Optimizations */
      @media (max-width: 768px) {
        .header {
          padding: 1.5rem 1rem;
        }

        .header h1 {
          font-size: 1.8rem;
        }

        .header-actions {
          position: static;
          justify-content: center;
          margin-bottom: 1rem;
        }

        .games-grid {
          grid-template-columns: 1fr;
          padding: 1rem;
          gap: 1.5rem;
        }

        .game-card {
          padding: 1.5rem;
        }

        .stats-panel {
          margin: 1rem;
          padding: 1.25rem;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      /* iPad Landscape Optimization */
      @media (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
        .games-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      /* Touch device optimizations */
      @media (hover: none) and (pointer: coarse) {
        .game-card,
        .stat-item {
          transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .floating-butterfly {
          animation: none;
          display: none; /* Hide animations for better performance */
        }

        body::before {
          animation: none; /* Reduce animations for battery */
        }
      }

      /* Reduce motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="pixel-moon"></div>
    <div class="floating-butterfly butterfly-1">
      <img src="assets/Butterfly1.png" alt="butterfly" />
    </div>
    <div class="floating-butterfly butterfly-2">
      <img src="assets/Butterfly5.png" alt="butterfly" />
    </div>
    <div class="floating-butterfly butterfly-3">
      <img src="assets/Butterfly10.png" alt="butterfly" />
    </div>

    <div class="header">
      <div class="header-actions">
        <a class="auth-link" id="authLink" href="html/butterfly-auth.html"
          >Sign In / Up</a
        >
        <div class="user-badge" id="userBadge" hidden>
          <img
            src="assets/Butterfly18.png"
            alt=""
            class="user-avatar"
            aria-hidden="true"
          />
          <div>
            <div class="user-label">Logged in as</div>
            <div class="user-name" id="userName">Keeper</div>
          </div>
          <button class="sign-out-btn" id="signOutBtn">Sign Out</button>
        </div>
      </div>
      <h1>
        <img
          src="assets/Butterfly15.png"
          style="
            width: 50px;
            vertical-align: middle;
            image-rendering: pixelated;
          "
        />
        Butterfly Hub
      </h1>
      <p>Your collection of magical butterfly games and experiences</p>
    </div>

    <div class="stats-panel">
      <div class="stats-title" id="statsOwner">Your Butterfly Collection</div>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value" id="totalGames">0</div>
          <div class="stat-label">Games Played</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="totalScore">0</div>
          <div class="stat-label">Total Score</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="butterfliesCaught">0</div>
          <div class="stat-label">Butterflies Caught</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="bestCombo">0</div>
          <div class="stat-label">Best Combo</div>
        </div>
      </div>
    </div>

    <div class="games-grid">
      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly8.png"
            style="width: 60px; image-rendering: pixelated"
          />
        </div>
        <h3 class="game-title">Butterfly Catching Game</h3>
        <p class="game-description">
          Test your reflexes in this exciting catching game with global
          leaderboards, daily challenges, and seasonal events!
        </p>
        <ul class="game-features">
          <li>Global leaderboards</li>
          <li>Daily challenges</li>
          <li>Seasonal events</li>
          <li>Multiple difficulty modes</li>
          <li>Achievement system</li>
        </ul>
        <button class="open-button" onclick="openGame('index.html')">
          Play Now
        </button>
      </div>

      <!--
        <div class="game-card">
          <div class="game-icon">
            <img
              src="assets/Butterfly20.png"
              style="width: 60px; image-rendering: pixelated"
            />
          </div>
          <h3 class="game-title">Glowing Butterfly Visual</h3>
          <p class="game-description">
            Watch the mesmerizing glowing blue butterfly with animated wings,
            twinkling stars, and interactive mouse effects.
          </p>
          <ul class="game-features">
            <li>Animated glowing wings</li>
            <li>Twinkling star background</li>
            <li>Mouse interaction</li>
            <li>Relaxing visuals</li>
            <li>Customizable colors</li>
          </ul>
          <button
            class="open-button"
            onclick="openGame('html/butterfly-component.html')"
          >
            View Butterfly
          </button>
        </div>
      -->

      <!--
        <div class="game-card">
          <div class="game-icon">
            <img
              src="assets/Butterfly25.png"
              style="width: 60px; image-rendering: pixelated"
            />
          </div>
          <h3 class="game-title">Butterfly Catching Mini-Game</h3>
          <p class="game-description">
            A standalone catching game with simple controls and fast-paced action.
            Perfect for quick gaming sessions!
          </p>
          <ul class="game-features">
            <li>Fast-paced gameplay</li>
            <li>Simple controls</li>
            <li>Score tracking</li>
            <li>Combo system</li>
            <li>Quick sessions</li>
          </ul>
          <button
            class="open-button"
            onclick="openGame('html/butterfly-catching-game.html')"
          >
            Play Mini-Game
          </button>
        </div>
      -->

      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly18.png"
            style="width: 60px; image-rendering: pixelated"
          />
        </div>
        <h3 class="game-title">Butterfly Journal</h3>
        <p class="game-description">
          Capture daily reflections, moods, and butterfly thoughts inside a
          dreamy digital journal with mood tracking and stats.
        </p>
        <ul class="game-features">
          <li>Daily mood tracker</li>
          <li>Guided butterfly thoughts</li>
          <li>Tag-based filtering</li>
          <li>Entry streak counter</li>
          <li>Local storage history</li>
        </ul>
        <button
          class="open-button"
          onclick="openGame('html/butterfly-journal.html')"
        >
          Open Journal
        </button>
      </div>

      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly4.png"
            style="width: 60px; image-rendering: pixelated"
            alt="Bible Console icon"
          />
        </div>
        <h3 class="game-title">Bible Console</h3>
        <p class="game-description">
          Dive into Scripture with a sleek, modern reader! Stream any chapter
          from the Berean Standard Bible, bookmark your favorite verses, and
          track your spiritual journeyâ€”all beautifully synced with your Hub
          profile. Your faith, digitized and elevated.
        </p>
        <ul class="game-features">
          <li>Live API scripture streaming</li>
          <li>Book + chapter navigator</li>
          <li>Verse bookmarking + history</li>
          <li>Reading progress tracker</li>
          <li>Hub-authenticated access</li>
        </ul>
        <button
          class="open-button"
          onclick="openGame('html/butterfly-bible.html')"
        >
          Launch Console
        </button>
      </div>

      <!-- <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly3.png"
            style="width: 60px; image-rendering: pixelated"
            alt="Purble Place inspired icon"
          />
        </div>
        <h3 class="game-title">Butterfly Pattern Lab</h3>
        <p class="game-description">
          Assemble neon butterfly orders in a Purble Place inspired arcade.
          Match wings, patterns, glows, and crowns before the queue backs up.
        </p>
        <ul class="game-features">
          <li>Randomized ticket queue</li>
          <li>Trait-based difficulty scaling</li>
          <li>Streak + score multipliers</li>
          <li>Hint + clear tray controls</li>
          <li>Local profile stats</li>
        </ul>
        <button
          class="open-button"
          onclick="openGame('html/butterfly-purble-place.html')"
        >
          Launch Lab
        </button>
      </div> -->

      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly15.png"
            style="width: 60px; image-rendering: pixelated"
            alt="Butterfly Pomodoro icon"
          />
        </div>
        <h3 class="game-title">Butterfly Pomodoro Lab</h3>
        <p class="game-description">
          Lock into dazzling Y2K focus loops with a neon timer, holographic
          calendar, streak charts, and butterfly-themed achievements synced to
          your Butterfly Hub profile.
        </p>
        <ul class="game-features">
          <li>Custom Pomodoro presets</li>
          <li>Task tagging + calendar logging</li>
          <li>Session + streak analytics</li>
          <li>Chart.js-powered dashboards</li>
          <li>Profile-aware progress saving</li>
        </ul>
        <button
          class="open-button"
          onclick="openGame('html/butterfly-pomodoro.html')"
        >
          Launch Tracker
        </button>
      </div>

      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly7.png"
            style="width: 60px; image-rendering: pixelated"
            alt="Butterfly+ Premium icon"
          />
        </div>
        <h3 class="game-title">Butterfly+ Premium</h3>
        <p class="game-description">
          Unlock the full magic of Butterfly Hub! Access exclusive Y2K themes,
          holographic skins, neon gradients, and aurora effects. Transform your
          entire experience with 8 stunning cosmetic themes.
        </p>
        <ul class="game-features">
          <li>8 gorgeous Y2K themes</li>
          <li>Holographic & neon effects</li>
          <li>Monthly or lifetime plans</li>
          <li>Instant theme switching</li>
          <li>Exclusive premium skins</li>
        </ul>
        <button
          class="open-button"
          onclick="openGame('html/butterfly-plus.html')"
        >
          Unlock Premium
        </button>
      </div>

      <div class="game-card">
        <div class="game-icon">
          <img
            src="assets/Butterfly12.png"
            style="width: 60px; image-rendering: pixelated"
          />
        </div>
        <h3 class="game-title">Coming Soon</h3>
        <p class="game-description">
          More butterfly experiences are on the way! Check back soon for new
          games and features.
        </p>
        <ul class="game-features">
          <li>Music visualizer</li>
          <li>Butterfly gallery</li>
          <li>Educational content</li>
          <li>Multiplayer mode</li>
          <li>And more...</li>
        </ul>
        <button
          class="open-button"
          style="opacity: 0.5; cursor: not-allowed"
          disabled
        >
          Coming Soon
        </button>
      </div>
    </div>

    <script>
      const AUTH_PAGE = "html/butterfly-auth.html";

      function getStoredUser() {
        const stored = localStorage.getItem("butterflyUser");
        if (!stored) return null;
        try {
          return JSON.parse(stored);
        } catch (error) {
          console.warn("Failed to parse butterflyUser", error);
          return null;
        }
      }

      function formatOwnerLabel(user) {
        if (!user || !user.username) {
          return "Your Butterfly Collection";
        }
        const name = user.username.trim();
        if (!name) return "Your Butterfly Collection";
        const possessive = name.endsWith("s") ? `${name}'` : `${name}'s`;
        return `${possessive} Butterfly Collection`;
      }

      function syncUserBadge() {
        const user = getStoredUser();
        const badge = document.getElementById("userBadge");
        const authLink = document.getElementById("authLink");
        const userNameEl = document.getElementById("userName");
        const statsOwner = document.getElementById("statsOwner");

        if (user && badge) {
          badge.removeAttribute("hidden");
          if (authLink) authLink.style.display = "none";
          if (userNameEl) {
            userNameEl.textContent = user.username || "Butterfly Keeper";
          }
          if (statsOwner) {
            statsOwner.textContent = formatOwnerLabel(user);
          }
        } else {
          if (badge) badge.setAttribute("hidden", "hidden");
          if (authLink) authLink.style.display = "inline-flex";
          if (statsOwner) {
            statsOwner.textContent = "Your Butterfly Collection";
          }
        }
      }

      const signOutBtn = document.getElementById("signOutBtn");
      if (signOutBtn) {
        signOutBtn.addEventListener("click", () => {
          localStorage.removeItem("butterflyUser");
          syncUserBadge();
          window.location.href = AUTH_PAGE;
        });
      }

      // Load player statistics
      function loadPlayerStats() {
        // Get legacy records (old builds stored per-game scores)
        const playerRecords =
          JSON.parse(localStorage.getItem("butterflyRecords")) || [];

        // Primary stats live under "butterflyStats" (leaderboard.js + game.js)
        const playerStats = JSON.parse(
          localStorage.getItem("butterflyStats")
        ) ||
          JSON.parse(localStorage.getItem("playerStats")) || {
            totalCaught: 0,
            bestCombo: 0,
            gamesPlayed: 0,
            totalScore: 0,
          };

        // Prefer the running totals from playerStats, fallback to legacy data
        const totalScore =
          playerStats.totalScore ||
          playerRecords.reduce((sum, record) => sum + record.score, 0);
        const gamesPlayed =
          playerStats.gamesPlayed || playerRecords.length || 0;
        const bestCombo = playerStats.bestCombo || 0;
        const totalCaught = playerStats.totalCaught || 0;

        // Update display
        document.getElementById("totalGames").textContent = gamesPlayed;
        document.getElementById("totalScore").textContent =
          totalScore.toLocaleString();
        document.getElementById("butterfliesCaught").textContent = totalCaught;
        document.getElementById("bestCombo").textContent = bestCombo;
      }

      // Open game in new tab
      function openGame(gameFile) {
        window.location.href = gameFile;
      }

      // Update stats when returning to hub
      function updateHubStats() {
        loadPlayerStats();
      }

      // Initialize when page loads
      window.addEventListener("load", function () {
        loadPlayerStats();
        syncUserBadge();

        // Check if we're returning from a game
        if (sessionStorage.getItem("returnedFromGame")) {
          updateHubStats();
          sessionStorage.removeItem("returnedFromGame");
        }
      });

      // Add some floating butterfly animations
      function createFloatingButterfly() {
        const butterfly = document.createElement("div");
        butterfly.className = "floating-butterfly";
        const img = document.createElement("img");
        const butterflyNum = Math.floor(Math.random() * 30) + 1;
        img.src = `assets/Butterfly${butterflyNum}.png`;
        img.alt = "butterfly";
        butterfly.appendChild(img);
        butterfly.style.left = Math.random() * 100 + "%";
        butterfly.style.top = Math.random() * 100 + "%";
        butterfly.style.animationDuration = Math.random() * 4 + 4 + "s";
        butterfly.style.animationDelay = Math.random() * 2 + "s";

        document.body.appendChild(butterfly);

        // Remove after animation
        setTimeout(() => {
          if (butterfly.parentNode) {
            butterfly.parentNode.removeChild(butterfly);
          }
        }, 8000);
      }

      // Create floating butterflies periodically
      setInterval(createFloatingButterfly, 3000);
    </script>
  </body>
</html>
